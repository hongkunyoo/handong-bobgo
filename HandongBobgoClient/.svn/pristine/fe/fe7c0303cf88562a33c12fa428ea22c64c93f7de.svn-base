package com.example.bobgo;

import android.app.Activity;
import android.content.Intent;
import android.database.Cursor;
import android.os.Bundle;
import android.provider.ContactsContract;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class FriendMatching extends Activity {

	String tag = null;
	
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.layout_friend_matching);
        
        Cursor cursor = getContentResolver().query(ContactsContract.Contacts.CONTENT_URI, null, null, null, ContactsContract.Contacts.DISPLAY_NAME + " ASC ");
    
        int end = cursor.getCount();
        //Log.d(tag, "end = " + end);
        
        String [] name = new String[end];
        int count = 0;
        
        if(cursor.moveToFirst()){
        	do{
        		name[count] = cursor.getString(cursor.getColumnIndex(ContactsContract.Data.DISPLAY_NAME));
        		//Log.d(tag, "name[" + count + "]=" + name[count]);
        		count++;
        	}while(cursor.moveToNext() || count < end);
        }
        cursor.close();
        
        ListView listView = (ListView)findViewById(R.id.listView1);
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(FriendMatching.this, android.R.layout.simple_list_item_1, name);
        listView.setAdapter(adapter);
        
        //if any friend has Bobgo app, then request him to make appointment with the user
        listView.setOnItemClickListener(new OnItemClickListener(){
        	public void onItemClick(AdapterView<?> parent, View view, int position, long id){
        		/*
        		String selectedName = parent.getItemAtPosition(position).toString();
        		Cursor c = getContentResolver().query(ContactsContract.Contacts.CONTENT_URI, null, 
        				ContactsContract.Data.DISPLAY_NAME+"='"+selectedName+"'", null, null);
        		while(c.moveToNext()){
        			String phone = c.getString(c.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));
        			Toast.makeText(getApplicationContext(),phone,Toast.LENGTH_SHORT).show();
        		}
        		c.close();*/
        		String selectedName = parent.getItemAtPosition(position).toString();
        		Intent i = new Intent(FriendMatching.this, FriendScheduleView.class);
        		i.putExtra("name", selectedName);
        		startActivity(i);
        	}
        });
        
       
		
    }
    
    
}